import{e as u,r as m,o as v,f,a as n,w as p,d as T,x as S,l as D,y as V,z as $,p as A,F as U,A as b,u as B,T as N,B as y,C as F,D as R,E as z,v as H}from"./index-B42yJtgC.js";const L={class:"text-center pa-4"},M={__name:"DialogExludeComponent",setup(x){const s=u(!1);return(i,t)=>{const o=m("v-btn"),g=m("v-card"),l=m("v-dialog");return v(),f("div",L,[n(o,{onClick:t[0]||(t[0]=d=>s.value=!0),"append-icon":"mdi-delete-circle"},{default:p(()=>t[4]||(t[4]=[T(" Exclude ")])),_:1}),n(l,{modelValue:s.value,"onUpdate:modelValue":t[3]||(t[3]=d=>s.value=d),width:"auto"},{default:p(()=>[n(g,{"max-width":"400","prepend-icon":"mdi-update",text:"Are you sure?",title:"Delete?"},{actions:p(()=>[n(o,{class:"ms-auto",text:"Cancel",onClick:t[1]||(t[1]=d=>s.value=!1)}),n(o,{class:"ms-auto",text:"Confirm",onClick:t[2]||(t[2]=d=>i.$emit("delete-confirm"))})]),_:1})]),_:1},8,["modelValue"])])}}},Y={__name:"TodoView",setup(x){const s=u(!1),i=u(""),t=u(""),o=S([]),g=u(""),l=b();D(()=>{localStorage.getItem("token")?(o.splice(0,o.length),c()):location.href="/"}),V(()=>{localStorage.getItem("token")?(o.splice(0,o.length),g.value=localStorage.getItem("username"),c()):location.href="/"});const d=e=>{const a={task:e,done:!1,todo_id:l.params.id};y(a).then(()=>c()).catch(_=>r(_))},c=()=>{$(l.params.id).then(e=>{o.splice(0,o.length,...e.data.tasks)}).catch(e=>r(e))},h=e=>{F(e._id,{done:e.done}).then(()=>c()).catch(a=>r(a))},k=e=>{R(e).then(()=>c()).catch(a=>r(a))},C=()=>{z(l.params.id).then(()=>c()).catch(e=>r(e))},I=()=>{H(l.params.id).then(()=>window.location.href="/user-info").catch(e=>r(e))},w=()=>{B({}),localStorage.removeItem("token"),localStorage.removeItem("username"),location.href="/"},E=()=>{console.warn("Error 401: UNAUTHORIZED"),i.value="Session Expired",t.value="Your session has been expired, please login again",s.value=!0},r=e=>{const{response:a}=e;a&&a.status===401?(E(),console.log(a.data.msg)):(console.log(e.message),i.value="Something got wrong",s.value=!0)};return(e,a)=>{const _=m("v-container");return v(),f(U,null,[n(_,{class:"text-center"},{default:p(()=>[n(N,{todos:o,onAddItem:d,onUpdateItem:h,onDeleteItem:k,onClearList:C},null,8,["todos"]),n(M,{onDeleteConfirm:I})]),_:1}),n(A,{msg:i.value,text:t.value,dialog:s.value,onClose:w},null,8,["msg","text","dialog"])],64)}}};export{Y as default};
